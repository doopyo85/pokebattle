<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Upload with Image Preview</title>
    <!-- 외부 CSS 파일 불러오기 -->
    <link rel="stylesheet" href="uploader-styles.css">
</head>
<body>

    <h2>File Upload & Image Preview</h2>
    <p class="lead">No Plugins <b>Just Javascript</b></p>

    <!-- Upload  -->
    <form id="file-upload-form" class="uploader">
        <input id="file-upload" type="file" name="fileUpload" accept="image/*" />
        <label for="file-upload" id="file-drag">
            <img id="file-image" src="#" alt="Preview" class="hidden">
            <div id="start">
                <i class="fa fa-download" aria-hidden="true"></i>
                <div>Select a file or drag here</div>
                <div id="notimage" class="hidden">Please select an image</div>
                <span id="file-upload-btn" class="btn btn-primary">Select a file</span>
            </div>
            <div id="response" class="hidden">
                <div id="messages"></div>
                <progress class="progress" id="file-progress" value="0">
                    <span>0</span>%
                </progress>
            </div>
        </label>
    </form>

    <div>Teachable Machine Image Model</div>
    <!-- Start 버튼을 클릭했을 때 init() 함수 호출 -->
    <button type="button" onclick="init()">Start</button>
    <button type="button" onclick="predict()">구별</button>
    <div id="label-container"></div>

    <!-- 추가된 테이블 -->
    <!-- Table Start -->
    <table id="table_id">
        <thead>
            <tr>
                <th width="30%">ROW_HEAD1</th>
                <td width="10%">Menu01</td>
                <td width="40%">Menu02</td>
                <td width="20%">Menu03</td>
            </tr>
        </thead>
        <tbody>
            <tr class="tr_color">
                <th>ROW_HEAD2</th>
                <td id="td1"></td>
                <td>Value02</td>
                <td>Value03</td>
            </tr>  
            <tr>   
                <th>ROW_HEAD3</th>
                <td>Value11</td>
                <td>Value12</td>
                <td>Value13</td>
            </tr>  
             <tr class="tr_color">  
                <th>ROW_HEAD4</th>
                <td>Value21</td>
                <td>Value22</td>
                <td>Value23</td>
            </tr>
        </tbody>
    </table>
    <!-- Table End -->

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
    <script type="text/javascript">
        // the link to your model provided by Teachable Machine export panel
        const URL = "./my_model/";

        let model, labelContainer, maxPredictions;

        // Load the image model
        async function init() {
            const modelURL = URL + "model.json";
            const metadataURL = URL + "metadata.json";

            // load the model and metadata
            model = await tmImage.load(modelURL, metadataURL);
            maxPredictions = model.getTotalClasses();

            // append elements to the DOM
            labelContainer = document.getElementById("label-container");
            for (let i = 0; i < maxPredictions; i++) { // and class labels
                labelContainer.appendChild(document.createElement("div"));
            }
        }

        // Function to handle image upload and prediction
        function handleImageUpload(event) {
            const file = event.target.files[0];
            const image = document.createElement('img');
            image.src = URL.createObjectURL(file);
            image.onload = async function() {
                await predict(image);
            };
        }

        // Attach event listener to handle image upload
        const fileInput = document.getElementById('file-upload');
        fileInput.addEventListener('change', handleImageUpload);
    </script>


    <!-- 스크립트 파일 연결 -->
    <script src="script.js"></script>
</body>
</html>
